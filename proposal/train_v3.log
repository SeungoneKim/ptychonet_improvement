Loading Flickr30K...
Total: 31014, Train: 28600, Test: 2414

======================================================================
Training ptychonetplus_step60: obj_size=428, n_pos=36
======================================================================
Params: 27,490,371
  Step 100/2500, loss=0.040483, lr=0.000199, time=48s
  Step 200/2500, loss=0.032028, lr=0.000197, time=94s
  Step 300/2500, loss=0.026453, lr=0.000193, time=140s
  Step 400/2500, loss=0.031968, lr=0.000188, time=186s
  Step 500/2500, loss=0.031402, lr=0.000181, time=231s
  >> Val: Amp=0.1647±0.0172, Phase=0.4946±0.1334
  Step 600/2500, loss=0.029057, lr=0.000173, time=282s
  Step 700/2500, loss=0.029362, lr=0.000164, time=328s
  Step 800/2500, loss=0.028798, lr=0.000154, time=374s
  Step 900/2500, loss=0.023373, lr=0.000143, time=421s
  Step 1000/2500, loss=0.021768, lr=0.000132, time=466s
  >> Val: Amp=0.1090±0.0168, Phase=0.3017±0.0754
  Step 1100/2500, loss=0.025761, lr=0.000120, time=517s
  Step 1200/2500, loss=0.021790, lr=0.000107, time=562s
  Step 1300/2500, loss=0.024690, lr=0.000095, time=608s
  Step 1400/2500, loss=0.024454, lr=0.000082, time=654s
  Step 1500/2500, loss=0.019867, lr=0.000070, time=700s
  >> Val: Amp=0.1036±0.0157, Phase=0.2902±0.0667
  Step 1600/2500, loss=0.019481, lr=0.000059, time=751s
  Step 1700/2500, loss=0.019858, lr=0.000048, time=796s
  Step 1800/2500, loss=0.021986, lr=0.000038, time=843s
  Step 1900/2500, loss=0.018090, lr=0.000029, time=889s
  Step 2000/2500, loss=0.020625, lr=0.000021, time=935s
  >> Val: Amp=0.0830±0.0186, Phase=0.2450±0.0746
  Step 2100/2500, loss=0.016209, lr=0.000014, time=985s
  Step 2200/2500, loss=0.020782, lr=0.000009, time=1031s
  Step 2300/2500, loss=0.023108, lr=0.000005, time=1077s
  Step 2400/2500, loss=0.020155, lr=0.000003, time=1123s
  Step 2500/2500, loss=0.018853, lr=0.000002, time=1168s
  >> Val: Amp=0.0796±0.0196, Phase=0.2396±0.0751

Final eval (DL only)...
  DL: Amp=0.0798±0.0201, Phase=0.2412±0.0768
Eval with refinement (5 steps)...
  Hybrid-5: Amp=0.0796±0.0196, Phase=0.2396±0.0751
Eval with refinement (10 steps)...
  Hybrid-10: Amp=0.0796±0.0196, Phase=0.2396±0.0751

======================================================================
Training ptychonetplus_step40: obj_size=328, n_pos=36
======================================================================
Params: 27,490,371
  Step 100/2000, loss=0.042210, lr=0.000199, time=38s
  Step 200/2000, loss=0.042800, lr=0.000195, time=74s
  Step 300/2000, loss=0.041851, lr=0.000189, time=111s
  Step 400/2000, loss=0.033089, lr=0.000181, time=148s
  Step 500/2000, loss=0.035328, lr=0.000171, time=185s
  >> Val: Amp=0.1664±0.0184, Phase=0.4636±0.1034
  Step 600/2000, loss=0.031927, lr=0.000159, time=226s
  Step 700/2000, loss=0.028047, lr=0.000146, time=263s
  Step 800/2000, loss=0.030835, lr=0.000132, time=299s
  Step 900/2000, loss=0.025861, lr=0.000116, time=337s
  Step 1000/2000, loss=0.033446, lr=0.000101, time=374s
  >> Val: Amp=0.1338±0.0164, Phase=0.3525±0.0912
  Step 1100/2000, loss=0.030648, lr=0.000086, time=415s
  Step 1200/2000, loss=0.023997, lr=0.000070, time=452s
  Step 1300/2000, loss=0.025791, lr=0.000056, time=489s
  Step 1400/2000, loss=0.027932, lr=0.000043, time=526s
  Step 1500/2000, loss=0.027081, lr=0.000031, time=563s
  >> Val: Amp=0.0927±0.0213, Phase=0.2783±0.0829
  Step 1600/2000, loss=0.026072, lr=0.000021, time=604s
  Step 1700/2000, loss=0.025015, lr=0.000013, time=641s
  Step 1800/2000, loss=0.025747, lr=0.000007, time=678s
  Step 1900/2000, loss=0.028023, lr=0.000003, time=715s
  Step 2000/2000, loss=0.024672, lr=0.000002, time=752s
  >> Val: Amp=0.0909±0.0213, Phase=0.2736±0.0825

Final eval (DL only)...
  DL: Amp=0.0908±0.0216, Phase=0.2745±0.0836
Eval with refinement (5 steps)...
  Hybrid-5: Amp=0.0909±0.0213, Phase=0.2736±0.0825
Eval with refinement (10 steps)...
  Hybrid-10: Amp=0.0909±0.0213, Phase=0.2736±0.0825

======================================================================
Training ptychonetplus_step20: obj_size=228, n_pos=36
======================================================================
Params: 27,490,371
  Step 100/2000, loss=0.050695, lr=0.000199, time=31s
  Step 200/2000, loss=0.051861, lr=0.000195, time=62s
  Step 300/2000, loss=0.045191, lr=0.000189, time=93s
  Step 400/2000, loss=0.043698, lr=0.000181, time=124s
  Step 500/2000, loss=0.043104, lr=0.000171, time=154s
  >> Val: Amp=0.1627±0.0196, Phase=0.4857±0.1254
  Step 600/2000, loss=0.039357, lr=0.000159, time=189s
  Step 700/2000, loss=0.035647, lr=0.000146, time=219s
